!function(t){var e={};function r(o){if(e[o])return e[o].exports;var a=e[o]={i:o,l:!1,exports:{}};return t[o].call(a.exports,a,a.exports,r),a.l=!0,a.exports}r.m=t,r.c=e,r.d=function(t,e,o){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(r.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)r.d(o,a,function(e){return t[e]}.bind(null,a));return o},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=11)}([function(t,e,r){var o=r(6);"string"==typeof o&&(o=[[t.i,o,""]]),o.locals&&(t.exports=o.locals);(0,r(4).default)("7429bd2d",o,!1,{})},function(t,e,r){var o=r(8);"string"==typeof o&&(o=[[t.i,o,""]]),o.locals&&(t.exports=o.locals);(0,r(4).default)("3c281d01",o,!1,{})},function(t,e,r){var o=r(10);"string"==typeof o&&(o=[[t.i,o,""]]),o.locals&&(t.exports=o.locals);(0,r(4).default)("2751a534",o,!1,{})},function(t,e,r){"use strict";t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var r=function(t,e){var r=t[1]||"",o=t[3];if(!o)return r;if(e&&"function"==typeof btoa){var a=(n=o,s=btoa(unescape(encodeURIComponent(JSON.stringify(n)))),u="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(s),"/*# ".concat(u," */")),i=o.sources.map((function(t){return"/*# sourceURL=".concat(o.sourceRoot||"").concat(t," */")}));return[r].concat(i).concat([a]).join("\n")}var n,s,u;return[r].join("\n")}(e,t);return e[2]?"@media ".concat(e[2]," {").concat(r,"}"):r})).join("")},e.i=function(t,r,o){"string"==typeof t&&(t=[[null,t,""]]);var a={};if(o)for(var i=0;i<this.length;i++){var n=this[i][0];null!=n&&(a[n]=!0)}for(var s=0;s<t.length;s++){var u=[].concat(t[s]);o&&a[u[0]]||(r&&(u[2]?u[2]="".concat(r," and ").concat(u[2]):u[2]=r),e.push(u))}},e}},function(t,e,r){"use strict";function o(t,e){for(var r=[],o={},a=0;a<e.length;a++){var i=e[a],n=i[0],s={id:t+":"+a,css:i[1],media:i[2],sourceMap:i[3]};o[n]?o[n].parts.push(s):r.push(o[n]={id:n,parts:[s]})}return r}r.r(e),r.d(e,"default",(function(){return v}));var a="undefined"!=typeof document;if("undefined"!=typeof DEBUG&&DEBUG&&!a)throw new Error("vue-style-loader cannot be used in a non-browser environment. Use { target: 'node' } in your Webpack config to indicate a server-rendering environment.");var i={},n=a&&(document.head||document.getElementsByTagName("head")[0]),s=null,u=0,l=!1,c=function(){},d=null,p="undefined"!=typeof navigator&&/msie [6-9]\b/.test(navigator.userAgent.toLowerCase());function v(t,e,r,a){l=r,d=a||{};var n=o(t,e);return m(n),function(e){for(var r=[],a=0;a<n.length;a++){var s=n[a];(u=i[s.id]).refs--,r.push(u)}e?m(n=o(t,e)):n=[];for(a=0;a<r.length;a++){var u;if(0===(u=r[a]).refs){for(var l=0;l<u.parts.length;l++)u.parts[l]();delete i[u.id]}}}}function m(t){for(var e=0;e<t.length;e++){var r=t[e],o=i[r.id];if(o){o.refs++;for(var a=0;a<o.parts.length;a++)o.parts[a](r.parts[a]);for(;a<r.parts.length;a++)o.parts.push(h(r.parts[a]));o.parts.length>r.parts.length&&(o.parts.length=r.parts.length)}else{var n=[];for(a=0;a<r.parts.length;a++)n.push(h(r.parts[a]));i[r.id]={id:r.id,refs:1,parts:n}}}}function f(){var t=document.createElement("style");return t.type="text/css",n.appendChild(t),t}function h(t){var e,r,o=document.querySelector('style[data-vue-ssr-id~="'+t.id+'"]');if(o){if(l)return c;o.parentNode.removeChild(o)}if(p){var a=u++;o=s||(s=f()),e=_.bind(null,o,a,!1),r=_.bind(null,o,a,!0)}else o=f(),e=x.bind(null,o),r=function(){o.parentNode.removeChild(o)};return e(t),function(o){if(o){if(o.css===t.css&&o.media===t.media&&o.sourceMap===t.sourceMap)return;e(t=o)}else r()}}var g,b=(g=[],function(t,e){return g[t]=e,g.filter(Boolean).join("\n")});function _(t,e,r,o){var a=r?"":o.css;if(t.styleSheet)t.styleSheet.cssText=b(e,a);else{var i=document.createTextNode(a),n=t.childNodes;n[e]&&t.removeChild(n[e]),n.length?t.insertBefore(i,n[e]):t.appendChild(i)}}function x(t,e){var r=e.css,o=e.media,a=e.sourceMap;if(o&&t.setAttribute("media",o),d.ssrId&&t.setAttribute("data-vue-ssr-id",e.id),a&&(r+="\n/*# sourceURL="+a.sources[0]+" */",r+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(a))))+" */"),t.styleSheet)t.styleSheet.cssText=r;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(r))}}},function(t,e,r){"use strict";var o=r(0);r.n(o).a},function(t,e,r){(e=r(3)(!1)).push([t.i,".input-group[data-v-30134f82]{margin-bottom:1px}.form-control[data-v-30134f82]{height:26px}.input-group-addon[data-v-30134f82]{cursor:pointer;width:26px;height:26px;padding:0}.input-group-addon[data-v-30134f82]:hover{background:#ccc}\n",""]),t.exports=e},function(t,e,r){"use strict";var o=r(1);r.n(o).a},function(t,e,r){(e=r(3)(!1)).push([t.i,"td[data-v-e26eef82]{vertical-align:middle}.oc-icon-undo[data-v-e26eef82]{position:absolute;right:15px;top:50%;transform:translateY(-50%);padding:5px 0 5px 8px}\n",""]),t.exports=e},function(t,e,r){"use strict";var o=r(2);r.n(o).a},function(t,e,r){(e=r(3)(!1)).push([t.i,".bundle-product-list-item{width:385px;background:white;margin:12px 10px 0 0;padding:10px 12px;position:relative}.bundle-product-list-item .image-attrs{display:flex}.bundle-product-list-item .product-image-col{width:120px;height:120px}.bundle-product-list-item .product-attrs-col{margin:0 0 0 10px}.bundle-product-list-item .product-attrs-col .attr-name{font-size:115%}.bundle-product-list-item .product-attrs-col .attr-quantity{margin-top:10px;display:flex}.bundle-product-list-item .product-attrs-col .attr-quantity .quantity-label{margin-right:15px;margin-top:5px}.bundle-product-list-item .product-attrs-col .attr-quantity .form-control{width:90px}.bundle-product-list-item .product-attrs-col .attr-quantity .btn{padding:6px 10px}.bundle-product-list-item .product-attrs-col .attr-default_price{margin-top:8px}.bundle-product-list-item .product-attrs-col .attr-price_override{margin-top:8px;display:flex}.bundle-product-list-item .product-attrs-col .attr-price_override .po-label{margin-right:15px;margin-top:5px}.bundle-product-list-item .product-attrs-col .attr-price_override .form-control{width:120px}.bundle-product-list-item .drag-handle{position:absolute;top:0;left:0;background:transparent;border:0;padding:4px 7px;cursor:grab}.bundle-product-list-item .drag-handle:hover{color:#00b}.bundle-product-list-item .drag-handle:focus,.bundle-product-list-item .drag-handle:active{outline:0;box-shadow:none}.bundle-product-list-item .btn-remove{position:absolute;top:0;right:0;background:transparent;border:0;padding:3px 7px}.bundle-product-list-item .btn-remove:hover{color:#b00}.bundle-product-list-item .btn-remove:focus,.bundle-product-list-item .btn-remove:active{outline:0;box-shadow:none}\n",""]),t.exports=e},function(t,e,r){"use strict";r.r(e);var o={bind(t,e,r){t._oldvalue=t.value},update(t,e,r){if("function"==typeof e.value?e.value(t.value):t.value.match(e.value))t._oldvalue=t.value;else{let e=t.selectionStart;t.value=t._oldvalue,t.dispatchEvent(new Event("input",{bubbles:!0})),t.setSelectionRange(e-1,e-1)}}},a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"percent-or-exact-price"},[r("div",{staticClass:"input-group"},[r("input",{staticClass:"form-control",attrs:{type:"text",disabled:"percent"!==t.local.valueType},domProps:{value:t.percentValue},on:{input:t.setValue}}),t._v(" "),r("span",{staticClass:"input-group-addon",on:{click:function(e){return t.setValueType("percent")}}},[t._v("%")])]),t._v(" "),r("div",{staticClass:"input-group"},[r("input",{staticClass:"form-control",attrs:{type:"text",disabled:"exactPrice"!==t.local.valueType},domProps:{value:t.exactPriceValue},on:{input:t.setValue}}),t._v(" "),r("span",{staticClass:"input-group-addon",on:{click:function(e){return t.setValueType("exactPrice")}}},[t._v("â‚¬")])])])};a._withStripped=!0;var i={model:{prop:"result"},props:["result","from-price"],computed:{local(){return this.result?this.result:{}},percentValue(){return""===this.local.value||void 0===this.local.value?"":"percent"===this.local.valueType?this.local.value:(1e4-Math.round(this.local.value/(this.fromPrice/1e4)))/100},exactPriceValue(){return""===this.local.value||void 0===this.local.value?"":"exactPrice"===this.local.valueType?this.local.value:Math.round(this.fromPrice*(100-this.local.value))/100}},methods:{setValue(t){var e={...this.local};("percent"===e.valueType&&this.percentValidate(t.target.value)||"exactPrice"===e.valueType&&this.exactPriceValidate(t.target.value))&&(e.value=t.target.value),this.$emit("input",e)},setValueType(t){var e={...this.local};e.value=this[t+"Value"],e.valueType=t,this.$emit("input",e)},percentValidate:t=>t.match(/^\d{0,3}(\.\d{0,2})?$/)&&t>=0&&t<=100,exactPriceValidate(t){return t.match(/^\d{0,9}(\.\d{0,2})?$/)&&t>=0&&t<=this.fromPrice}}};r(5);function n(t,e,r,o,a,i,n,s){var u,l="function"==typeof t?t.options:t;if(e&&(l.render=e,l.staticRenderFns=r,l._compiled=!0),o&&(l.functional=!0),i&&(l._scopeId="data-v-"+i),n?(u=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),a&&a.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(n)},l._ssrRegister=u):a&&(u=s?function(){a.call(this,(l.functional?this.parent:this).$root.$options.shadowRoot)}:a),u)if(l.functional){l._injectStyles=u;var c=l.render;l.render=function(t,e){return u.call(e),c(t,e)}}else{var d=l.beforeCreate;l.beforeCreate=d?[].concat(d,u):[u]}return{exports:t,options:l}}var s=n(i,a,[],!1,null,"30134f82",null);s.options.__file="vuebackend/components/percent-or-exact-price.vue";var u=s.exports,l=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("div",{staticClass:"clearfix"},[r("button",{staticClass:"btn btn-default oc-icon-plus",attrs:{type:"button"},on:{click:t.addItem}},[t._v("Add product")])]),t._v(" "),r("draggable",{staticStyle:{display:"flex"},attrs:{list:t.value,handle:".drag-handle"}},t._l(t.value,(function(e,o){return r("div",{key:e.product.id},[r("list-item",{attrs:{customergroups:t.customergroups},on:{delete:function(e){return t.deleteItem(o)}},model:{value:t.value[o],callback:function(e){t.$set(t.value,o,e)},expression:"value[i]"}})],1)})),0),t._v(" "),r("modal",{model:{value:t.addItemModalOpen,callback:function(e){t.addItemModalOpen=e},expression:"addItemModalOpen"}},[r("div",{attrs:{id:t.addProductListId}}),t._v(" "),r("div",{attrs:{slot:"footer"},slot:"footer"},[r("btn",{on:{click:function(e){t.addItemModalOpen=!1}}},[t._v("Cancel")])],1)])],1)};l._withStripped=!0;var c=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"bundle-product-list-item"},[r("div",{staticClass:"image-attrs"},[r("img",{staticClass:"product-image-col",attrs:{src:t.local.product.main_image}}),t._v(" "),r("div",{staticClass:"product-attrs-col"},[r("div",{staticClass:"attr-name",domProps:{textContent:t._s(t.local.product.name+" ("+t.local.product.id+")")}}),t._v(" "),r("div",{staticClass:"attr-quantity"},[r("div",{staticClass:"quantity-label"},[t._v("Quantity:")]),t._v(" "),r("div",{staticClass:"input-group"},[r("div",{staticClass:"input-group-btn"},[r("btn",{attrs:{type:"default"},on:{click:function(e){return t.quantityDec(t.local)}}},[r("i",{staticClass:"icon-minus"})])],1),t._v(" "),r("input",{directives:[{name:"model",rawName:"v-model",value:t.local.quantity,expression:"local.quantity"},{name:"validate",rawName:"v-validate",value:/^\d{0,9}$/,expression:"/^\\d{0,9}$/"}],staticClass:"form-control input-sm",attrs:{type:"text"},domProps:{value:t.local.quantity},on:{input:function(e){e.target.composing||t.$set(t.local,"quantity",e.target.value)}}}),t._v(" "),r("div",{staticClass:"input-group-btn"},[r("btn",{attrs:{type:"default"},on:{click:function(e){return t.quantityInc(t.local)}}},[r("i",{staticClass:"icon-plus"})])],1)])]),t._v(" "),r("div",{staticClass:"attr-default_price"},[t._v("Product default price: "),r("span",{domProps:{textContent:t._s(t.local.product.default_price)}})]),t._v(" "),r("div",{staticClass:"attr-price_override"},[r("div",{staticClass:"po-label"},[t._v("Override price:")]),t._v(" "),r("input",{directives:[{name:"model",rawName:"v-model",value:t.local.price_override,expression:"local.price_override"},{name:"validate",rawName:"v-validate",value:/^\d{0,7}(\.\d{0,2})?$/,expression:"/^\\d{0,7}(\\.\\d{0,2})?$/"}],staticClass:"form-control input-sm",attrs:{type:"text"},domProps:{value:t.local.price_override},on:{input:function(e){e.target.composing||t.$set(t.local,"price_override",e.target.value)}}})])])]),t._v(" "),r("bp-customergroup-prices",{attrs:{customergroups:t.customergroups,product:t.local.product},model:{value:t.local.bpCustomergroups,callback:function(e){t.$set(t.local,"bpCustomergroups",e)},expression:"local.bpCustomergroups"}}),t._v(" "),t._m(0),t._v(" "),r("button",{staticClass:"btn-remove",attrs:{type:"button"},on:{click:function(e){return t.$emit("delete")}}},[r("i",{staticClass:"icon-close"})])],1)};c._withStripped=!0;var d=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("div",[t._v("Prices for customer groups")]),t._v(" "),r("table",{staticClass:"table"},[t._m(0),t._v(" "),t._l(t.value,(function(e,o){return r("tr",{key:e.customergroup_id},[r("td",{staticStyle:{"padding-right":"10px"},domProps:{textContent:t._s(t.customergroups[e.customergroup_id].name)}}),t._v(" "),r("td",{staticStyle:{position:"relative"}},[r("span",{domProps:{textContent:t._s(t.customergroups[e.customergroup_id].discount_percent+"%")}}),t._v(" "),r("btn",{staticClass:"oc-icon-undo",attrs:{type:"primary"},on:{click:function(e){t.value[o].overrideDiscount={}}}})],1),t._v(" "),r("td",[r("percent-or-exact-price",{attrs:{"from-price":t.product.default_price},model:{value:t.value[o].overrideDiscount,callback:function(e){t.$set(t.value[o],"overrideDiscount",e)},expression:"value[i].overrideDiscount"}})],1)])}))],2)])};d._withStripped=!0;var p={props:["value","customergroups","product"]},v=(r(7),n(p,d,[function(){var t=this.$createElement,e=this._self._c||t;return e("tr",[e("th",[this._v("Group")]),this._v(" "),e("th",[this._v("Group discount")]),this._v(" "),e("th",[this._v("Custom discount")])])}],!1,null,"e26eef82",null));v.options.__file="formwidgets/bundleproductlist/assets/bp-customergroup-prices.vue";var m={components:{bpCustomergroupPrices:v.exports},props:["value","customergroups"],computed:{local(){return this.value?this.value:{}}},methods:{quantityInc(t){t.quantity++},quantityDec(t){t.quantity>1&&t.quantity--}}},f=(r(9),n(m,c,[function(){var t=this.$createElement,e=this._self._c||t;return e("button",{staticClass:"drag-handle",attrs:{type:"button"}},[e("i",{staticClass:"icon-arrows"})])}],!1,null,null,null));f.options.__file="formwidgets/bundleproductlist/assets/list-item.vue";var h=n({components:{listItem:f.exports},props:["value","customergroups","addProductListId"],data:()=>({addItemModalOpen:!1}),computed:{local(){return this.value?this.value:[]}},methods:{addItem(){this.addItemModalOpen=!0,$.request("onGetAvailableItems",{data:{existingItems:this.value.map(t=>t.product.id)}})},deleteItem(t){this.value.splice(t,1)},onSelectProduct(t){$.request("onGetProductData",{data:{productId:t},success:(t,e,r)=>{this.value.push({product:t.product,quantity:1,price_override:null,bpCustomergroups:null}),this.addItemModalOpen=!1}})}}},l,[],!1,null,null,null);h.options.__file="formwidgets/bundleproductlist/assets/bundle-product-list.vue";var g={components:{bundleProductList:h.exports},data:()=>({items:[],customergroups:[],addProductListId:null}),mounted(){this.items=JSON.parse($("#"+$(this.$el).data("widget-id")+"-formValue").text()),this.customergroups=JSON.parse($("#"+$(this.$el).data("widget-id")+"-customergroups").text()),this.addProductListId=$(this.$el).data("add-product-list-id")},computed:{saveValue(){return JSON.stringify({status:"ok",items:this.items.map(t=>({product_id:t.product.id,quantity:t.quantity,price_override:t.price_override,bpCustomergroups:t.bpCustomergroups}))},null,2)}}};Vue.directive("validate",o),Vue.component("percent-or-exact-price",u),window.vbus.appDefinition.bundleProductList=g}]);